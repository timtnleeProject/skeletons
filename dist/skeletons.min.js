!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){const o=n(1);window&&(window.Skeletons=o)},function(t,e,n){const o=n(2),i=n(3),r=n(4);function a(t,e){this.schema=t,this.default={dataName:"data",schemaName:"schema",console:!0,throw:!1},e=a.setDefault(e,this.default);for(let t in e)this.default[t]=e[t]}o(a),i(a),r(a),t.exports=a},function(t,e){t.exports=function(t){t.String=function(e){return new t.Types(e,"StringFn",{})},t.Array=function(e){return new t.Types(e,"ArrayFn",{item:null})},t.Boolean=function(e){return new t.Types(e,"BooleanFn",{})},t.Number=function(e){return new t.Types(e,"NumberFn",{allowNaN:!0})},t.Object=function(e){return new t.Types(e,"ObjectFn",{class:null,object:{}})},t.MapObject=function(e){return new t.Types(e,"MapObjectFn",{keyValidator:null,item:null})},t.Function=function(e){return new t.Types(e,"FunctionFn",{})},t.Symbol=function(e){return new t.Types(e,"SymbolFn",{})},t.Null=function(e){return new t.Types(e,"NullFn",{})},t.Any=function(e){return new t.Types(e,"AnyFn",{exclude:null,include:null})},t.Types=function(e,n,o){const i={required:!0,default:void 0,validator:null},r=Object.assign(i,o);this.opt=t.setDefault(e,r),this.fname=n},t.Warnings=function(e){new t({code:Number,log:String,type:String,depth:t.Array()}).validate(e,{throw:!0});for(let t in e)this[t]=e[t]},t.typeof=function(t){return null===t?"null":Array.isArray(t)?"array":typeof t},t.getKeyStr=function(t){let e="";return t.forEach(t=>{e+=`[${"string"==typeof t?`'${t}'`:t}]`}),e||" "},t.setDefault=function(e,n){if(e||(e=n),"object"!==t.typeof(e))throw"Skeletons.valid(data, options), options must be object";for(let t in n)void 0===e[t]&&(e[t]=n[t]);return e}}},function(t,e){t.exports=function(t){t.prototype.validate=function(e,n){const o=Object.assign({root:this,isbranch:!1},this.default);n=t.setDefault(n,o);for(let t in n)this[t]=n[t];return this.data=e,this.valid=!0,this.warnings=[],this.lookup([]),this},t.prototype.lookup=function(e){e=e||[];let{schema_deep:n,data_deep:o}=this.getDepth(e);if(n instanceof t.Types){const t=n;return void this[t.fname](t.opt,e)}if("function"==typeof n){const i=typeof n();if(i!==typeof o){let n=t.typeof(o);this.warn(e,`expect [${i}] but got [${n}]`,0)}return}if("object"!==t.typeof(n))return void this.warn(e,"is not a valid schema and will be ignored, please fixed it.",99);const i=t.typeof(o);if("object"!=i)return this.warn(e,`expect object, got ${i}`,1);let r={...o};for(let t in n)delete r[t],this.lookup([...e,t]);for(let t in r)this.warn(e,`property '${t}' not defined in schema`,5)},t.prototype.getDepth=function(t){let e=this.schema,n=this.data;return t.forEach(t=>{e=e[t],n=n[t]}),{schema_deep:e,data_deep:n}},t.prototype.warn=function(e,n,o){!0===this.valid&&(this.valid=!1);let i="",r=o>=10?this.schemaName:this.dataName;switch(o){case 0:i="[Unexpected Type]";break;case 1:i="[Not Object]";break;case 2:i="[Value invalid]";break;case 5:i="[Unknown Property]";break;case 6:i="[keyValidator failed]";break;case 7:i="[Types Not Matched]";break;case 8:i="[Class Not Matched]";break;case 99:i="[Wrong Schema]"}const a=`Skeletons Warn: ${i} at ${r}${t.getKeyStr(e)}: ${n}`;if(this.warnings.push(new t.Warnings({code:o,log:n,type:i,depth:e})),!this.isbranch){if(this.throw||o>=10)throw a;return this.console?console.log(a):void 0}},t.prototype.useOriginWarn=function({warnings:t,originDepth:e,schemaName:n}){t.forEach(t=>{const o=this.schema_name;this.schemaName=n;let i=t.code>10?t.depth:[...e,...t.depth];this.warn(i,t.log,t.code),this.schemaName=o})}}},function(t,e){t.exports=function(t){t.prototype.SOP=function(e,n,o,i){let{data_deep:r}=this.getDepth(n);if(!(!1===e.required&&void 0===r||void 0!==e.default&&r===e.default)){if(i(r)){if(e.validator){if("function"!=typeof e.validator)return this.warn(n,"validator must be a function",99);if(!0!==e.validator(r,this.root.data))return this.warn(n,"validation failed",2)}return 200}{const e=t.typeof(r);this.warn(n,`expect [${o}] but got [${e}]`,0)}}},t.prototype.ArrayFn=function(e,n){if(200==this.SOP(e,n,"array",t=>Array.isArray(t))&&e.item){const{data_deep:o}=this.getDepth(n),i=new t(e.item);o.forEach((e,o)=>{i.validate(e,{isbranch:!0,root:this}),i.valid||this.useOriginWarn({warnings:i.warnings,originDepth:[...n,o],schemaName:this.schemaName+t.getKeyStr(n)+", Skeletons.Array({ item }) item"})})}},t.prototype.ObjectFn=function(e,n){if(200!=this.SOP(e,n,"object",e=>"object"===t.typeof(e)))return;const{data_deep:o}=this.getDepth(n);if(e.class){if("function"!=typeof e.class)return this.warn(n,"class is not a function",99);o instanceof e.class||this.warn(n,`object expect instanceof [${e.class.name}] but got [${Object.getPrototypeOf(o).constructor.name}]`,8)}if(e.object){if("object"!==t.typeof(e.object))return this.warn(n,"Skeletons.Object({ object }) object must be an object {}",99);if(e.object instanceof t.Types&&"ObjectFn"!=e.object.fname)return this.warn(n,"Skeletons.Object({ object }) object must be an object {} or Skeletons.Object()",99);const i=new t(e.object);i.validate(o,{isbranch:!0,root:this}),i.valid||this.useOriginWarn({warnings:i.warnings,originDepth:n,schemaName:this.schemaName+t.getKeyStr(n)})}},t.prototype.MapObjectFn=function(e,n){if(200!=this.SOP(e,n,"object",e=>"object"===t.typeof(e)))return;const{data_deep:o}=this.getDepth(n);if(e.keyValidator){if("function"!=typeof e.keyValidator)return this.warn(n,"Skeletons.MapObject({ keyValidator }) keyValidator must be function",99);for(let t in o)!0!==e.keyValidator(t,this.root.data)&&this.warn(n,`keyValidator failed at key ${t}`,6)}if(e.item){const i=new t(e.item);for(let e in o)i.validate(o[e],{isbranch:!0,root:this}),i.valid||this.useOriginWarn({warnings:i.warnings,originDepth:[...n,e],schemaName:this.schemaName+t.getKeyStr(n)+", Skeletons.MapObject({ item })"})}},t.prototype.FunctionFn=function(e,n){this.SOP(e,n,"function",e=>"function"===t.typeof(e))},t.prototype.NullFn=function(e,n){this.SOP(e,n,"null",e=>"null"===t.typeof(e))},t.prototype.StringFn=function(t,e){this.SOP(t,e,"string",t=>"string"==typeof t)},t.prototype.NumberFn=function(t,e){if(200!=this.SOP(t,e,"number",t=>"number"==typeof t))return;const{data_deep:n}=this.getDepth(e);!1===t.allowNaN&&isNaN(n)&&this.warn(e,"Skeletons.Number({ allowNaN:false }), NaN value not allowed",0)},t.prototype.BooleanFn=function(t,e){this.SOP(t,e,"boolean",t=>"boolean"==typeof t)},t.prototype.SymbolFn=function(t,e){this.SOP(t,e,"symbol",t=>"symbol"==typeof t)},t.prototype.AnyFn=function(e,n){if(this.SOP(e,n,"any",()=>!0),e.include&&e.exclude)return this.warn(n,"Skeletons.Any({ include, exclude }): you defined both include and exclude, which can only be one of them.",99);if(e.include){if(!Array.isArray(e.include))return this.warn(n,"Skeletons.Any({ include }): include must be array",99);const{data_deep:o}=this.getDepth(n);let i=!1;for(let n=0;n<e.include.length;n++){let r=e.include[n],a=new t(r);if(a.validate(o,{isbranch:!0,root:this}),a.valid){i=!0;break}}i||this.warn(n,"value no matched type for Skeletons.Any({ include })",7)}if(e.exclude){if(!Array.isArray(e.exclude))return this.warn(n,"Skeletons.Any({ exclude }): exclude must be array",99);const{data_deep:o}=this.getDepth(n);let i=!0;for(let n=0;n<e.exclude.length;n++){let r=e.exclude[n],a=new t(r);if(a.validate(o,{isbranch:!0,root:this}),a.valid){i=!1;break}}i||this.warn(n,"value type exists in Skeletons.Any({ exclude })",7)}}}}]);