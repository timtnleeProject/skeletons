window.Skeletons=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t){t.exports=JSON.parse('{"a":"0.1.4-beta-3"}')},function(t,e,n){"use strict";n.r(e);var o=n(0);var i,a=function(t){t.prototype.validate=function(e,n={}){const o=Object.assign({root:this,isbranch:!1},this.default);return n=t.setDefault(n,o),Object.assign(this,n),this.data=e,this.valid=!0,Object.defineProperty(this,"store",{value:{},configurable:!0,enumerable:!0,writable:!1}),this.warnings=[],this.lookup([]),this},t.prototype.subValidate=function(t,e){return this.validate(t,{isbranch:!0,root:e})},t.prototype.lookup=function(e=[]){let{schema_deep:n,data_deep:o}=this.getDepth(e);if(n instanceof t.Types){const t=n;return void this[t.fname](t.opt,e)}if("function"==typeof n){const i=typeof n();if(i!==typeof o){let n=t.typeof(o);this.warn(e,`expect [${i}] but got [${n}]`,0)}return}const i=t.typeof(n);if("array"===i){const i=t.typeof(o);if("array"!==i)return void this.warn(e,`expect [array] but got [${i}]`,0);if(n.forEach((t,n)=>{this.lookup([...e,n])}),n.length<o.length){let t=n.length;for(;t<o.length;)this.warn([...e,t],`index [${t}] not defined in schema`,4),t++}return}if("object"!==i)return void this.warn(e,"is not a valid schema and will be ignored, please fixed it.",99);const a=t.typeof(o);if("object"!=a)return this.warn(e,`expect object, got ${a}`,1);let r={...o};for(let t in n)delete r[t],this.lookup([...e,t]);if(!this.rule.extraKey)for(let t in r)this.warn(e,`property '${t}' not defined in schema`,5)},t.prototype.getDepth=function(t){let e=this.schema,n=this.data;return t.forEach(t=>{e=e[t],n=n[t]}),{schema_deep:e,data_deep:n}},t.prototype.warn=function(e,n,o){!0===this.valid&&(this.valid=!1);let i="",a=o>=10?this.schemaName:this.dataName;switch(o){case 0:i="[Unexpected Type]";break;case 2:i="[Value invalid]";break;case 4:i="[Unknown index]";break;case 5:i="[Unknown Property]";break;case 6:i="[keyValidator failed]";break;case 7:i="[Types Not Matched]";break;case 8:i="[Class Not Matched]";break;case 99:i="[Wrong Schema]"}const r=`Skeletons Warn: ${i} at ${a}${t.getKeyStr(e)}: ${n}`;if(this.warnings.push(new t.Warnings({code:o,log:n,type:i,depth:e})),!this.isbranch){if(this.throw||o>=10)throw r;return this.console?console.log(r):void 0}},t.prototype.useOriginWarn=function({warnings:t,originDepth:e,schemaName:n}){t.forEach(t=>{const o=this.schemaName;this.schemaName=`${o}: ${n}`;let i=t.code>10?[]:[...e,...t.depth];t.code>10&&(this.isbranch=!1),this.warn(i,t.log,t.code),this.schemaName=o})}};function r(t,e={}){this.schema=t,this.default={dataName:"data",schemaName:"schema",console:!0,throw:!1,rule:{extraKey:!1}},this.default=r.setDefault(e,this.default)}(function(t){t._version_=o.a,t.String=function(e){return new t.Types(e,"StringFn",{})},t.Array=function(e){const n={item:null,array:void 0};return new t.Types(e,"ArrayFn",n)},t.Boolean=function(e){return new t.Types(e,"BooleanFn",{})},t.Number=function(e){return new t.Types(e,"NumberFn",{allowNaN:!0})},t.Object=function(e){return new t.Types(e,"ObjectFn",{class:null,extraKey:!1,object:{}})},t.MapObject=function(e){return new t.Types(e,"MapObjectFn",{keyValidator:null,item:null})},t.Function=function(e){return new t.Types(e,"FunctionFn",{})},t.Symbol=function(e){return new t.Types(e,"SymbolFn",{})},t.Null=function(e){return new t.Types(e,"NullFn",{})},t.Any=function(e){return new t.Types(e,"AnyFn",{exclude:null,include:null})},t.Types=function(e={},n,o){const i={required:!0,default:void 0,validator:null},a=Object.assign(i,o);this.opt=t.setDefault(e,a),this.fname=n},t.Warnings=function(e){new t({code:Number,log:String,type:String,depth:t.Array()}).validate(e,{throw:!0});for(let t in e)this[t]=e[t]},t.typeof=function(t){return null===t?"null":Array.isArray(t)?"array":typeof t},t.getKeyStr=function(t){let e="";return t.forEach(t=>{e+=`[${"string"==typeof t?`'${t}'`:t}]`}),e||" "},t.setDefault=function(e,n){if(!e)return n;if("object"!==t.typeof(e))throw"Skeletons.setDefault(data, options), options must be object";for(let t in n)void 0===e[t]&&(e[t]=n[t]);return e},t.expectType=function(e){return e instanceof t.Types?e.name.toLowerCase():"function"==typeof e?t.typeof(e()):t.typeof(e)}})(r),a(r),(i=r).prototype.SOP=function(t,e,n,o){let{data_deep:a}=this.getDepth(e);if(!(!1===t.required&&void 0===a||void 0!==t.default&&a===t.default)){if(o(a)){if(t.validator){if("function"!=typeof t.validator)return this.warn(e,"options.validator must be a function",99);if(!0!==t.validator(a,this.root.data,this.root.store))return this.warn(e,"validation failed",2)}return 200}{const t=i.typeof(a);this.warn(e,`expect [${n}] but got [${t}]`,0)}}},i.prototype.ArrayFn=function(t,e){if(200!=this.SOP(t,e,"array",t=>Array.isArray(t)))return;const{data_deep:n}=this.getDepth(e);if(t.item){const o=new i(t.item);n.forEach((t,n)=>{o.subValidate(t,this.root),o.valid||this.useOriginWarn({warnings:o.warnings,originDepth:[...e,n],schemaName:"Skeletons.Array({ item }) options.item"})})}if(void 0!==t.array){const o=t.array;if("array"!==i.typeof(o))return this.warn(e,"Skeletons.Array({ array }) options.array must be an array iteral schema []",99);const a=new i(o);a.subValidate(n,this.root),a.valid||this.useOriginWarn({warnings:a.warnings,originDepth:[...e],schemaName:"Skeletons.Array({ array }) options.array"})}},i.prototype.ObjectFn=function(t,e){if(200!=this.SOP(t,e,"object",t=>"object"===i.typeof(t)))return;const{data_deep:n}=this.getDepth(e);if(t.class){if("function"!=typeof t.class)return this.warn(e,"Skeletons.Object({ class }) options.class is not a function/class",99);n instanceof t.class||this.warn(e,`object expect instanceof [${t.class.name}] but got instanceof [${Object.getPrototypeOf(n).constructor.name}]`,8)}if(t.object){if("object"!==i.typeof(t.object))return this.warn(e,"Skeletons.Object({ object }) options.object must be an object {}",99);if(t.object instanceof i.Types)return this.warn(e,"Skeletons.Object({ object }) options.object can only use literal object schema {}",99);const o=new i(t.object,{rule:{extraKey:t.extraKey}});o.subValidate(n,this.root),o.valid||this.useOriginWarn({warnings:o.warnings,originDepth:e,schemaName:"Skeletons.Object({ object }) options.object"})}},i.prototype.MapObjectFn=function(t,e){if(200!=this.SOP(t,e,"object",t=>"object"===i.typeof(t)))return;const{data_deep:n}=this.getDepth(e),o={keyValidator:!1,validateItem:!1},a=n=>{o.keyValidator&&!0!==t.keyValidator(n,this.root.data,this.root.store)&&this.warn(e,`keyValidator failed at key ${n}`,6)},r=(t,n,i)=>{o.validateItem&&(i.subValidate(n[t],this.root),i.valid||this.useOriginWarn({warnings:i.warnings,originDepth:[...e,t],schemaName:"Skeletons.MapObject({ item }) options.item"}))};if(t.keyValidator){if("function"!=typeof t.keyValidator)return this.warn(e,"Skeletons.MapObject({ keyValidator }) options.keyValidator must be function",99);o.keyValidator=!0}if(t.item&&(o.validateItem=!0),!o.validateItem&&!o.keyValidator)return;const s=new i(t.item);for(let t in n)a(t),r(t,n,s)},i.prototype.FunctionFn=function(t,e){this.SOP(t,e,"function",t=>"function"===i.typeof(t))},i.prototype.NullFn=function(t,e){this.SOP(t,e,"null",t=>"null"===i.typeof(t))},i.prototype.StringFn=function(t,e){if(200===this.SOP(t,e,"string",t=>"string"==typeof t)&&t.match){if(!(t.match instanceof RegExp))return this.warn(e,"options.match must be a RegExp",99);const{data_deep:n}=this.getDepth(e);n.match(t.match)||this.warn(e,"Skeletons.String({ match }), value do not matches",2)}},i.prototype.NumberFn=function(t,e){if(200!=this.SOP(t,e,"number",t=>"number"==typeof t))return;const{data_deep:n}=this.getDepth(e);!1===t.allowNaN&&isNaN(n)&&this.warn(e,"Skeletons.Number({ allowNaN:false }), NaN value not allowed",0)},i.prototype.BooleanFn=function(t,e){this.SOP(t,e,"boolean",t=>"boolean"==typeof t)},i.prototype.SymbolFn=function(t,e){this.SOP(t,e,"symbol",t=>"symbol"==typeof t)},i.prototype.AnyFn=function(t,e){if(this.SOP(t,e,"any",()=>!0),t.include&&t.exclude)return this.warn(e,"Skeletons.Any({ include, exclude }): you defined both include and exclude, which can only be one of them.",99);if(t.include){if(!Array.isArray(t.include))return this.warn(e,"Skeletons.Any({ include }): include must be array",99);const{data_deep:n}=this.getDepth(e);let o=!1;for(let e=0;e<t.include.length;e++){let a=t.include[e],r=new i(a);if(r.subValidate(n,this.root),r.valid){o=!0;break}}o||this.warn(e,"validation fail at Skeletons.Any({ include }): ",7)}if(t.exclude){if(!Array.isArray(t.exclude))return this.warn(e,"Skeletons.Any({ exclude }): exclude must be array",99);const{data_deep:n}=this.getDepth(e);let o=!0;for(let e=0;e<t.exclude.length;e++){let a=t.exclude[e],r=new i(a);if(r.subValidate(n,this.root),r.valid){o=!1;break}}o||this.warn(e,"validation fail at Skeletons.Any({ exclude })",7)}};e.default=r}]);